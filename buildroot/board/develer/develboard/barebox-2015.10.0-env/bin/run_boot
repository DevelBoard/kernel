#!/bin/sh

. /env/config

if [ "x${global.boot_loc.kernel}" = "xtftp" ]; then
	tftp $kernelimage
	tftp $oftreeimage

elif [ "x${global.boot_loc.kernel}" = "xmmc" ]; then
	mkdir -p /mmc
	mount $mmc_bootdev /mmc/
	cp -v /mmc/$kernelimage $kernelimage
	cp -v /mmc/$oftreeimage $oftreeimage
	umount /mmc
fi


if [ "x${global.boot_loc.rootfs}" = "xtftp" ]; then
	tftp $initrdimage

elif [ "x${global.boot_loc.rootfs}" = "xmmc" ]; then
	mkdir -p /mmc
	mount $mmc_bootdev /mmc/
	cp -v /mmc/$initrdimage $initrdimage
	umount /mmc
fi

bootm
